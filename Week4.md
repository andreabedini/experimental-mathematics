---
subject: Lecture Notes
title: MAST90053 Experimental Mathematics
author: "Lecturer: Dr Andrea Bedini"
date: 2014, Semester 1, Week 4
bibliography: bibliography.bib
header-includes:
    \usepackage{algorithm}
    \usepackage{algorithmic}
    \renewcommand{\algorithmicrequire}{\textbf{Input:}}
    \renewcommand{\algorithmicensure}{\textbf{Output:}}
    \usepackage{polynom}
    \def\CC{\mathbb{C}}
    \def\RR{\mathbb{R}}
    \def\NN{\mathbb{N}}
    \newcommand{\<}{\left\langle}
    \renewcommand{\>}{\right\rangle}
    \def\gcd{\operatorname{gcd}}
    \def\lcm{\operatorname{lcm}}
    \def\deg{\operatorname{deg}}
    \def\lt{\operatorname{lt}}
    \def\lp{\operatorname{lp}}
    \def\lc{\operatorname{lc}}
---

Gröbner basis
==============

This section is a very brief introduction to Gröbner bases, largerly adapted from @adams1994introduction.

In many instances we are interested in the set of roots of a system of
nonlinear equations. For example, let $f_i\in\RR[x_1,\dotsc,x_n]$ be
polynomials in $n$ variables with real coefficients. In geometry, a
variety $V(f_1,\dotsc,f_s)$ can be defined as the set of all solutions
of the equations
$$
f_1=0,\quad f_2=0, \quad \dotsc,\quad f_s=0,
$$
or more formally, if $S\subseteq\RR[x_1,\dotsc,x_n]$,
$$
V(S) = \{ (a_1,\dotsc,a_n)^n \in \RR\ |\ f(a_1,\dotsc,a_n) = 0 \text{ for all } f \in S\}.
$$

There are many (numerical) algorithms for solving systems of equations, but these generally do not take the geometry of the variety into account. The computation of solutions for may drastically improve if the given system of equations is transformed into a different system with the same solutions. This will be done by considering the ideal generated by the polynomials $f_1, \dotsc, f_s$, denoted by $\<f_1, \dotsc, f_s\>$.
$$
\<f_1, \dotsc, f_n\> = \left\{ \sum_{i=1}^s u_i f_i \ |\ u_i \in \RR[x_1,\dotsc,x_n], i=1,\dotsc,s \right\}
$$

The linear case
---------------

In this section we consider the system
$$
f_1=0,\quad f_2=0, \quad \dotsc,\quad f_s=0, \text{ where each $f_i$ is linear}
.
$$
In this case, the algorithmic method to solve such system is the row reduction which changes the above system to row echelon form. Let's consider an example.

\example Let $f_1=x+y-z$ and $f_2=2x+3y+2z$ be linear polynomials in $\RR[x,y,z]$. We consider the ideal $I = \<f_1,f_2\>$ and the variety $V(f_1,f_2)$, that is, the solution to the system
$$
\left\{\begin{aligned}
x & + y && - z && = 0 \\
2x & + 3y && + 2z && = 0 .
\end{aligned}\right
.
$$
We now perform row reduction on the matrix associated with this sytem
$$
\begin{pmatrix} 1 & 1 & -1 \\ 2 & 3 & 2 \end{pmatrix}
\longrightarrow
\begin{pmatrix} 1 & 1 & -1 \\ 0 & 1 & 4 \end{pmatrix}
.
$$
The last matrix is in row echelon form. The solution of the original system are the same as those of the following system
$$
\left\{\begin{aligned}
x & + y && - z && = 0 \\
& + y && + 4z && = 0 .
\end{aligned}\right.
$$
and are now easily obtained parametrically as $x = 5z$ and $y = -4z$.

The reduction process is, in fact, a method to change a generating set for the ideal $I = \<f_1,f_2\>$ into another generating set. In this case we created a new polynomial $f_3 = f_2 - 2 f_1 = y+4z$, and replaced $f_2$ by $f_3$. Since $f_2$ can be written as $2 f_1 + f_3$, the ideal $I = \< f_1, f_2 \>$ can also be generated by $\< f_1, f_3\>$.

The process by which the polynomial $f_2$ was replaced by $f_3$ using $f_1$ is called reduction of $f_2$ by $f_1$, and we write
$$
f_2 \overset{f_1}{\longrightarrow} f_3
.
$$
The polynomial $f_3$ can be viewed as a reminder of a certain division: we used the first term of $f_1$, namely $x$, to eliminate a term from $f_2$, namely $2x$. Since the first term of $f_1$ cannot eliminate any other terms, the division stops and the reminder is exactly $f_3$.

One variable case
-----------------

In this section we consider polynomials in $\RR[x]$. If $f = a_x x^n + a_{n-1} x^{n-1} + \dotso + a_0$, with $a_n \neq 0$, then: the _degree_ of $f$ is $\deg(f)=n$; the _leading term_ is $\lt(f) = a_n x^n$; the _leading power_ is $\lp(f) = x^n$; and the _leading coefficient_, denoted by $\lc(f) = a_n$.

\example Let $f=x^3-2x^2+2x+8$ and $g=2x^2+3x+1$. We can divide $f$ by $g$ to get the quotient $\tfrac12 x - \tfrac74$ and remainder $\tfrac{27}4 x + \tfrac{39}4$ as follows:
$$
\polylongdiv[style=A]{x^3-2x^2+2x+8}{2x^2+3x+1}
$$
so we have $f = (\tfrac12 x - \tfrac74)g + \tfrac{27}4 x + \tfrac{39}4$. The idea was to multiply $g$ by an appropriate term, namely $\tfrac12 x$, so taht the leading term of $g$ times this term cancelled the leading term of $f$. After this cancellation we obtained the first reminder $h = f - \tfrac12 x g = -\tfrac72 x^2 + \tfrac32 x + 8$. Using the notation introduced above we note that the factor of $g$ in the product is $\frac{lt(f)}{lt(g)}$ and so we get $h = f - \frac{lt(f)}{lt(g)} g$ as the first reminder. Again, we call $h$ a _reduction_ of $f$ by $g$ and we write
$$
f \overset{g}{\longrightarrow} h
.
$$
At variance with the example in previous section, we can now repeat this process on $h$ obtaining the second, and final, reminder $r = \tfrac{27}4 x + \tfrac{39}4$. This can be written using the notation
$$
f \overset{g}{\longrightarrow} h \overset{g}{\longrightarrow} r
$$
or, simply,
$$
f \overset{g}{\longrightarrow}_+ r
$$
If we now consider the ideal $I = \<f,g\>$, it is clear that a new generating set would be $\<g,r\>$. In fact, reducing $g$ by $r$ and repeating the process one more it follows that the ideal $I$ is generated by one element, which in this case is the constant function (hence there are no solutions to the equations $f(x)=g(x)=0$).

\theorem Every ideal of $I = \<f_1, \dotsc, f_s\> \subseteq \RR[x]$ is generated by one element $g = \gcd(f_1, \dotsc, f_s)$.

\noindent
This theorem shows that a variety defined by $s$ equations
$$
f_1 = f_2 = \dotso = f_s = 0,
$$
where $f_i \in \RR[x]$ and $i=1,\dotsc,s$ has precisely the same set of solutions as the single equation $g=\gcd(f_1, \dotsc, f_s)=0$, where $\langle f_1,\ldots,f_s\rangle = \langle g\rangle$. The function $\gcd(f_1, \dotsc, f_s)$ is therefore the "best" generating set for $V(I)$.

\begin{algorithm}
\caption{One variable division algorithm}
\begin{algorithmic}
\REQUIRE $f, g \in \RR[x]$, with $g \neq 0$
\ENSURE $q, r$ such that $f = q g + r$ and $r=0$ or $\deg(r) \leq \deg(g)$
\STATE $q \leftarrow 0$
\STATE $r \leftarrow f$
\WHILE{$r \neq 0$ \AND $\deg(g) \leq \deg(r)$}
\STATE $q \leftarrow q + \frac{\lt(r)}{\lt(g)}$
\STATE $r \leftarrow r - \frac{\lt(r)}{\lt(g)}g$
\ENDWHILE
\end{algorithmic}
\end{algorithm}

Term ordering
-------------

In the previous examples we implicitly used a choice of ordering of the monomials: we used the highest degree term first in the reduction process. When dealing with more than one variable, also a choice of order among the various variables has to be made. Two common choices of order among variables are the _lexicographical_ and _degree lexicographical_ order.

We will denote $x_1^{\beta_1} \dotsm x_n^{\beta_n}$ by $\boldsymbol{x^\beta}$ where $\boldsymbol{\beta} = (\beta_1, \dotsc, \beta_n) \in \NN^n$. Also, by convention, $x_1 > x_2 > \dotso > x_n$.

\definition Lexicographic (lex) ordering.
$$
\boldsymbol{x^\alpha} < \boldsymbol{x^\beta}
\Leftrightarrow\left\{
\text{\parbox{0.5\columnwidth}{%
the first coordinates $\alpha_i$ and $\beta_i$ in $\boldsymbol\alpha$ and $\boldsymbol\beta$, which are different, satisfy $\alpha_i < \beta_i$
}}\right.
$$

In the case of two variables $x_1$ and $x_2$, the lex order gives
$$
1 < x_2 < x_2^2 < \dotso < x_1 < x_1 x_2 < x_1 x_2^2 < \dotso < x_1^2 < \dotso.
$$

\definition Lexicographic (lex) ordering.
$$
\boldsymbol{x^\alpha} < \boldsymbol{x^\beta}
\Leftrightarrow\left\{
\text{\parbox{0.5\columnwidth}{%
$\sum_{i=1}^n \alpha_i < \sum_{i=1}^n \beta_i$ \\ or \\
$\sum_{i=1}^n \alpha_i = \sum_{i=1}^n \beta_i$ and $\boldsymbol{x^\alpha} < \boldsymbol{x^\beta}$ with respect to the lexicographic order.
}}\right.
$$

In the case of two variables $x_1$ and $x_2$, the deglex order gives
$$
1 < x_2 < x_1 < x_2^2 < x_1 x_2 < x_1^2 < x_2^3 < x_1x_2^2 < x_1^2x_2 < x_1^3 < \ldots.
$$

Multivariate reduction
----------------------

In the previous sections we had a division algorithm, also referred to as a reduction process. We now need to extend this algorithm to the multivariate case.

The basic idea behind the algorithm is the same as for linear and one variable polynomials: when dividing $f$ by $f_1,\dotsc,f_s$, we want to cancel terms of $f$ using the leading terms of the $f_i$'s (so the new terms which are introduced are smaller than the cancelled terms). We want to continue this process until it cannot be done anymore.

\definition Given $f, g, h \in \RR[x_1,\dotsc,x_s]$, with $g \neq 0$, we say that $f$ reduces to $h$ modulo $g$ in one step, written
$$
f \overset{g}{\longrightarrow} h,
$$
if and only if $\lp(f)$ divides a non-zero term $X$ of $f$ and
$$
h = f - \frac{X}{\lt(g)}g
.
$$

\example Let $f=y^2 x + 4yx -3x^2$, $g = 2y+x+1$, and let the term order be deglex with $y > x$. Then we can write the following chain of reductions:
$$
f
\overset{g}{\longrightarrow} -\frac12 y x^2 + \frac72 yx -3x^2
\overset{g}{\longrightarrow} \frac14 x^3 + \frac72 yx - \frac{11}4 x^2
\overset{g}{\longrightarrow} \frac14 x^3 - \frac92 x^2 - \frac{7}4 x
$$
Note that in the last polynomial no term is divisible by $\lp(g) = y$ and so this procedure cannot continue.

\definition A polynomial $r$ is called _reduced_ with respect to a set of non-zero polynomials $F = \{f_1, \dotsc, f_s\}$ if $r = 0$ or no term in $r$ is divisible by any one of the $\lp(f_i)$, $i = 1,\dotsc,s$.

\begin{algorithm}
\caption{Multivariate division algorithm}
\begin{algorithmic}
\REQUIRE $f, f_1, \dotsc, f_s \in \RR[x_1,\dotsc,x_n]$, with $f_i \neq 0$, $i = 1,\dotsc,s$
\ENSURE $u_1,\dotsc,u_s,r$ such that $f = u_1 f_1 + \dotsc \ u_s f_s + r$ and $r$ is reduced w.r.t. $\{f_1, \dotsc, f_s\}$ and $\max(\lp(u_1)\lp(f_1),\dotsc,\lp(u_s)\lp(f_s),\lp(r)) = \lp(f)$.
\FOR{$i=1$ \TO $s$}
\STATE $u_i \leftarrow 0$
\ENDFOR
\STATE $r \leftarrow 0$
\STATE $h \leftarrow f$
\WHILE{$h \neq 0$}
\IF{there exist $i$ such that $\lp(f_i)$ divides $lp(h)$}
\STATE $u_i \leftarrow u_i + \frac{\lt(h)}{\lt(f_i)}$
\STATE $h \leftarrow h - \frac{\lt(h)}{\lt(f_i)} f_i$
\ELSE
\STATE $r \leftarrow r + \lt(h)$
\STATE $h \leftarrow h - \lt(h)$
\ENDIF
\ENDWHILE
\end{algorithmic}
\end{algorithm}

Given a term order, we use tha above algorithm to reduce a system of equations by a set of predefined functions, by systematically removing the largest monomials. This is by no means a unique process, as can be seen in the next example.

\example Let $f(x,y)=y^2x-x$, and let $I=\<f_1,f_2\>$ where
$f_1(x,y)=yx-y$, $f_2(x,y)=y^2-x$. Using the deglex ordering with $y>x$,
we find $$f(x,y)=yf_1(x,y)+f_2(x,y),$$ and hence has zero remainder.
However, if we first reduce with respect to $f_2$, we find
$$f(x,y)=xf_2(x,y) + x^2-x.$$ In this case, the remainder $x^2-x$ is
non-zero but reduced with respect to $\{f_1,f_2\}$.

The ambiguity in this example can be resolved by finding another generating set for $I$. This finally leads to the definition of a Gröbner basis:

\definition A set of nonzero polynomials $G=\{g_1,\dotsc,g_s\}$ contained in an ideal $I$, is called a Gröbner basis for $I$ if for all $f\in \RR[x_1,\ldots,x_n]$ the remainder of the division of $f$ by $G$ is unique.

The following observaton provides a pathway to the construction of such bases. In the division of $f$ by $f_1,\dotsc,f_s$, it may happen, as it does in the above example, that some term $X$ in $f$ is divisible by both $\lp(f_i)$ and $\lp(f_j)$ for $i \neq j$. Hence $X$ is divisible by $L = \lcm(\lp(f_i),\lp(f_j))$. If we reduce $f$ using $f_i$, we get the polynomial $h_1 = f - \frac{X}{\lt(f_i)} f_i$, and if we reduce $f$ using $f_j$, we get $h_2 = f - \frac{X}{\lt(f_j)} f_j$. The ambiguity introduced is
$$
h_2 - h_1 = \frac{X}{\lt(f_i)} f_i - \frac{X}{\lt(f_j)} f_j = \frac{X}{L} S(f_i, f_j),
$$
where $S(f, g)$ is given by
$$
S(f, g) = \frac{L}{\lt(f)} f - \frac{L}{\lt(g)} g
$$
and is called the S-polynomial of $f$ and $g$. 

The classical algorithm for computing Gröbner bases is the Buchberger’s algorithm. It constructs a Gröbner bases by making sure all S-polynomials can be reduced to zero.

\begin{algorithm}
\caption{Buchberger’s algorithm for computing Gröbner bases}
\begin{algorithmic}
\REQUIRE $F=\{f_1, \dotsc, f_s\} \subseteq \RR[x_1,\dotsc,x_n]$, with $f_i \neq 0$, $i = 1,\dotsc,s$
\ENSURE $G=\{g_1,\dotsc,g_t\}$, a Gröbner bases for $\<f_1, \dotsc, f_s\>$
\STATE $G \leftarrow F$
\STATE $\mathcal G \leftarrow \{ \{f_i, f_j\}\ |\ f_i \neq f_j \in G \}$
\WHILE{$\mathcal G \neq \emptyset$}
\STATE Choose any $\{f,g\} \in \mathcal G$
\STATE $\mathcal G \leftarrow \mathcal G - \{\{f,g\}\}$
\STATE $S(f,g) \overset{G}{\longrightarrow}_+ h$, where $h$ is reduced w.r.t. $G$
\IF{$h \neq 0$}
\STATE $\mathcal G \leftarrow \mathcal G \cup \{\{u,h\}\ |\ \text{for all } u \in G\}$
\STATE $G \leftarrow G \cup \{h\}$
\ENDIF
\ENDWHILE
\end{algorithmic}
\end{algorithm}

<!-- \example Let $f_1 = y^2 + yx + x^2$, $f_2 = y + x$, and $f_3 = y$. Let us use the deglex order with $y > x$ to compute the Gröbner basis for $I = \<f_1,f_2,f_3\>$.

\noindent
First we set $G = \{f_1,f_2,f_3\}$ and $\mathcal G = \{\{f_1,f_2\},\{f_2,f_3\},\{f_1,f_3\}\}$.

\noindent
We pick a pair in $\mathcal G$, $\{f_1,f_2\}$ and we compute $S(f_1,f_2) \overset{G}{\longrightarrow}_+ x^2 = f_4$. Then we add $f_4$ to $G = \{f_1,f_2,f_3,f_4\}$ and
$$
\mathcal G = \{\{f_1,f_2\},\{f_2,f_3\},\{f_1,f_3\},\{f_1,f_4\},\{f_2,f_4\},\{f_3,f_4\}\}
$$.

\noindent
We repeat the loop, we pick the pair $\{f_1,f_3\}$ in $\mathcal G$ and we compute $S(f_1,f_3) \overset{G}{\longrightarrow}_+ 0$. -->


\exercise Implement the multivariate division and Buchberger’s algorithms in `Mathematica`. You can use the following definitions for $\lp, \lt$, and $\lc$. 

```Mathematica
lt[poly_]:=FromCoefficientRules[
  {CoefficientRules[poly, variables, order] // First},
  variables]
lp[poly_]:=Times@@(variables^
    CoefficientRules[poly, variables, order][[1, 1]])
lc[poly_]:=CoefficientRules[poly, variables, order][[1, 2]]
```

These definitions are based on global definitions of `variables` and `order`.

```Mathematica
variables={x,y};
order=Lexicographic; (* or DegreeLexicographic *)

f = 3 x^3 y^3 + 2 y^2;

lp[f] (* returns x^3 y^3 *)
```

Test your code against `Mathematica` functions `PolynomialReduce` and `GroebnerBasis`. Make sure `Mathematica` is using the same term ordering as your code (using your definition of `variables` and `order`).

```Mathematica
PolynomialReduce[f,F,variables,
  MonomialOrder->order]
GroebnerBasis[F,variables,MonomialOrder->order]
```

The 3-colour problem
====================

This section is an adaption of Section 2.7 from @adams1994introduction, in which we illustrate how the technique of Gröbner bases can be used to determine whether a graph can be 3-coloured.

Consider the following problem. Given a graph $G$ with $n$ vertices with at most one edge between any two vertices. Can we colour the vertices, using only three colours, in such a way that no two vertices connected by an edge have the same colour? In order to use Gröbner bases we have to capture this problem in a set of polynomial equations, which is done as follows. Let the three colours be represented by the three cube roots of unity $1,\xi,\xi^2$ where $\xi^3=1$. Each vertex is to be assigned one of these three colours, and this can be represented by the equations
$$
x_i^3-1=0, \quad i=1,\dotsc,n
$$
However, if vertex $i$ and $j$ are adjacent their colours need to be different, i.e. $x_i\neq x_j$. This can be transformed into an equation by observing that $0=x_i^3-x_j^3 = (x_i-x_j)(x_i^2 +x_ix_j+x_j^2)$. Hence, if $i$ and $j$ are adjacent vertices with different colours, we must have that
$$
x_i^2 + x_i x_j + x_j^2 = 0.
$$

Let $I$ be the ideal of $\CC[x_1,\ldots,x_n]$ generated by the above two sets of polynomials. Then, the graph $G$ is 3-colourable if $V(I)\neq \emptyset$. To establish whether or not $V(I)=\emptyset$, we compute a Gröbner basis $B$ for $I$. If $1\in B$, then $V(I)=\emptyset$ and otherwise $V(I)\neq \emptyset$.

\exercise Consider the graph on the right. Using `GroebnerBasis`, determine whether or not $G$ is 3-colourable. If $G$ is 3-colourable, find a 3-colouring.

\begin{figure}
\centering
\includegraphics[width=0.5\columnwidth]{3colorgraph}
\caption{The graph $G$.}
\end{figure}

# References
\setlength{\parindent}{0cm}
